<?php


   function send_notification_to_app($tokens, $title,$body,$code,$parent_id)
    {
        $url = 'https://fcm.googleapis.com/fcm/send';
        $fields = array(
             'registration_ids' => $tokens,
             'notification' => array(
                                    "title" => $title,
                                    "body" => $body, ),
              'data' => array(
                                    
                        "code" => $code, 
                                        
                                            ),
            );

        $headers = array(
            'Authorization: key=AAAAPqbFT6g:APA91bHLOKJKKEdfTBBz8M1JXAee747IKilyd8AuyXZ_rikrosWdnOlPhpWLHCrQdPOTPuIIOTkc6IaCs9Weef1VMXnCR9RPv3ZCUyXMC1z7mm33kB7qfq22uBGwGDrkZ9-545u9j9wc',
            'Content-Type: application/json'
            );
        $ch = curl_init();
        curl_setopt($ch, CURLOPT_URL, $url);
        curl_setopt($ch, CURLOPT_POST, true);
        curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
        curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 0);
        curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
        curl_setopt($ch, CURLOPT_POSTFIELDS, json_encode($fields));
        $result = curl_exec($ch);
        if ($result === false) {
            //die('Curl failed: ' . curl_error($ch));
        }
        curl_close($ch);
         mysql_query("INSERT INTO `notifications`(`notification_id`, `parent_id`, `title`, `message`) VALUES (null,'".$parent_id."','".$title."','".$body."')")or die(mysql_error());
        return $result;
    }

function today($var1, $var2)
{
$result = mysql_query("SELECT * FROM class_history WHERE date_admin = '$var1' and monitor_id = '$var2'");
if (!$result) 
	{
    die("Query to show fields from table failed");
	}
$rnumberOfRows = MYSQL_NUMROWS($result);
echo $rnumberOfRows;
}
function time1($var){
$result1 = mysql_query("SELECT * FROM timestart Where time_s_id = '$var'");
if (!$result1) 
	{
    die("Query to show fields from table failed");
	}
$tnumberOfRows1 = MYSQL_NUMROWS($result1);
If ($tnumberOfRows1 == 0){
			echo '0';
			}
		else if ($tnumberOfRows1 > 0) 
			{
					$hidden_tt = MYSQL_RESULT($result1,$i,"time_s");
	
			  		echo $hidden_tt;
			}
}
function StudentName($var){
$result1 = mysql_query("SELECT * FROM course Where course_id = '$var'");
if (!$result1) 
	{
    die("Query to show fields from table failed");
	}
$tnumberOfRows1 = MYSQL_NUMROWS($result1);
If ($tnumberOfRows1 == 0){
			echo '';
			}
		else if ($tnumberOfRows1 > 0) 
			{
					$hidden_tt = MYSQL_RESULT($result1,$i,"course_yrSec");
	
			  		echo $hidden_tt;
			}
}
function DeptName($var){
$result1 = mysql_query("SELECT * FROM dept Where dept_id = '$var'");
if (!$result1) 
	{
    die("Query to show fields from table failed");
	}
$tnumberOfRows1 = MYSQL_NUMROWS($result1);
If ($tnumberOfRows1 == 0){
			echo '';
			}
		else if ($tnumberOfRows1 > 0) 
			{
					$hidden_tt = MYSQL_RESULT($result1,$i,"department");
	
			  		echo $hidden_tt;
			}
}
function TeacherName($var){
$result1 = mysql_query("SELECT * FROM profile Where teacher_id = '$var'");
if (!$result1) 
	{
    die("Query to show fields from table failed");
	}
$tnumberOfRows1 = MYSQL_NUMROWS($result1);
If ($tnumberOfRows1 == 0){
			echo '';
			}
		else if ($tnumberOfRows1 > 0) 
			{
					$hidden_tt = MYSQL_RESULT($result1,$i,"teacher_name");
	
			  		echo $hidden_tt;
			}
}
function MonitorName($var, $var1, $var2){
if ($var2 == 2){ $all = '<i class="fa fa-clock-o"></i>'; }
else { $all = ''; }
$result1 = mysql_query("SELECT * FROM monitor Where mnt_id = '$var'");
if (!$result1) 
	{
    die("Query to show fields from table failed");
	}
$tnumberOfRows1 = MYSQL_NUMROWS($result1);
If ($tnumberOfRows1 == 0){
			echo '';
			}
		else if ($tnumberOfRows1 > 0) 
			{
					$hidden_tt = MYSQL_RESULT($result1,$i,"mnt_name");
	
			  		if ($var1 == 11){
			  		echo '<span class="label label-sm label-warning">'.$all.' On Trial ('.$hidden_tt.')</span>';
			  		}
			  		elseif ($var1 == 17){
			  		echo '<span class="label label-sm label-danger">'.$all.' Suspended ('.$hidden_tt.')</span>';
			  		}
			  		elseif ($var1 == 18){
			  		echo '<span class="label label-sm label-danger">'.$all.' Shifted ('.$hidden_tt.')</span>';
			  		}
			  		elseif ($var1 == 19){
			  		echo '<span class="label label-sm label-info">'.$all.' Advance ('.$hidden_tt.')</span>';
			  		}
			  		elseif ($var1 == 20){
			  		echo '<span class="label label-sm label-warning">'.$all.' Re-Scheduled ('.$hidden_tt.')</span>';
			  		}
			  		else {
			  		echo '<span class="label label-sm label-success">'.$all.' Regular ('.$hidden_tt.')</span>';
			  		}
			}
}
?>